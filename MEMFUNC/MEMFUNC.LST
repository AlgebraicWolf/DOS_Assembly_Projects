Turbo Assembler	 Version 4.1	    02/25/20 01:38:22	    Page 1
memfunc.asm



      1				     .186
      2	0000			     .model tiny
      3
      4				     locals @@
      5
      6	0000			     .data
      7	0000  41 41 41 41 42 24	     Str1    db	"AAAAB$"
      8	0006  41 41 41 41 43 24	     Str2    db	"AAAAC$"
      9
     10	000C			     .code
     11				     org 100h
     12
     13	0100			     Start:
     14	0100  8C D8			 mov ax, ds
     15	0102  8E C0			 mov es, ax
     16	0104  BF 0006r			 mov di, offset	Str2
     17	0107  BE 0000r			 mov si, offset	Str1
     18	010A  B9 0006			 mov cx, 6
     19	010D  E8 001B			 call memcmp
     20
     21	0110  B4 24			 mov ah, '$'
     22	0112  BF 0000r			 mov di, offset	Str1
     23	0115  BE 0006r			 mov si, offset	Str2
     24	0118  E8 003B			 call strcmp
     25
     26	011B  B0 24			 mov al, '$'
     27	011D  BF 0000r			 mov di, offset	Str1
     28	0120  BE 0006r			 mov si, offset	Str2
     29	0123  E8 0015			 call strlen
     30	0126  CD 20			 int 20h
     31
     32
     33				     ;================================================
     34				     ; Function	that searches first occurance of byte
     35				     ; ENTER: ES:[DI] -	Address	to start search
     36				     ;	      CX - Amount of bytes to search
     37				     ;	      AL - Byte	to search for
     38				     ; EXIT:  ES:[DI] -	Pointer	to the symbol to the
     39				     ;			end of string
     40				     ;	      ZF - Whether value was found
     41				     ; DESTR: CX
     42				     ;================================================
     43	0128			     memchr  proc
     44	0128  F2> AE			 repne scasb
     45	012A  C3			 ret
     46	012B			     memchr   endp
     47
     48
     49				     ;================================================
     50				     ; Function	that compares two arrays of bytes
     51				     ; ENTER: DS:[SI] -	First array
     52				     ;	      ES:[DI] -	Second array
     53				     ;	      CX - Array length
     54				     ; EXIT: DS:[SI] - Pointer to the end of search
     55				     ;	     ES:[DI] -		   -||-
     56				     ;	     ZF	- Whether end was reachd
     57				     ;	     AH	- Difference (first - second)
Turbo Assembler	 Version 4.1	    02/25/20 01:38:22	    Page 2
memfunc.asm



     58				     ; DESTR: CX
     59				     ;================================================
     60	012B			     memcmp  proc
     61	012B  F3> A6			 repe cmpsb
     62	012D  8A 64 FF			 mov ah, byte ptr ds:[si-1]
     63	0130  26: 2A 65	FF		 sub ah, byte ptr es:[di-1]
     64	0134  C3			 ret
     65	0135			     memcmp  endp
     66
     67				     ;================================================
     68				     ; Function	that sets value	to an array
     69				     ; ENTER: ES:[DI] -	Array
     70				     ;	      AH - Value
     71				     ;	      CX - Array length
     72				     ; DESTR: ES:[DI], CX
     73				     ;================================================
     74	0135			     memset  proc
     75	0135  F3> AA			 rep stosb
     76	0137  C3			 ret
     77	0138			     memset  endp
     78
     79				     ;================================================
     80				     ; Copies one array	into another
     81				     ; ENTER: DS:[SI] -	Source
     82				     ;	      ES:[DI] -	Destination
     83				     ;	      CX - Array length
     84				     ; DESTR: DS:[SI], ES:[DI],	CX
     85				     ;================================================
     86	0138			     memcpy   proc
     87	0138  F3> A4			 rep movsb
     88	013A  C3			 ret
     89	013B			     memcpy  endp
     90
     91				     ;================================================
     92				     ; Function	that calculates	length of string
     93				     ; ENTER: AL - String terminator
     94				     ;	      ES:[DI] -	String
     95				     ; EXIT:  CX - Length
     96				     ; DESTR: ES:[DI]
     97				     ;================================================
     98	013B			     strlen  proc
     99	013B  33 C9			 xor cx, cx
    100	013D			     @@Search:
    101	013D  AE			 scasb
    102	013E  74 03			 je @@End
    103	0140  41			 inc cx
    104	0141  EB FA			 jmp @@Search
    105	0143			     @@End:
    106	0143  C3			 ret
    107	0144			     strlen  endp
    108
    109				     ;================================================
    110				     ; Function	that searches for symbol in string
    111				     ; ENTER: AH - Symbol to search for
    112				     ;	      BH - String terminator
    113				     ;	      ES:[DI] -	String
    114				     ; EXIT: ES:[DI] - Pointer to symbol
Turbo Assembler	 Version 4.1	    02/25/20 01:38:22	    Page 3
memfunc.asm



    115				     ; DESTR: AL
    116				     ;================================================
    117	0144			     strchr  proc
    118	0144			     @@Search:
    119	0144  AC			 lodsb
    120	0145  3A E0			 cmp ah, al
    121	0147  74 06			 je @@End
    122	0149  3A F8			 cmp bh, al
    123	014B  74 02			 je @@End
    124	014D  EB F5			 jmp @@Search
    125	014F			     @@End:
    126	014F  C3			 ret
    127	0150			     strchr  endp
    128
    129				     ;================================================
    130				     ; Function	that copies string
    131				     ; ENTER: DS:[SI] -	String to copy from
    132				     ;	      ES:[DI] -	String to copy to
    133				     ;	      AH - String terminator
    134				     ; DESTR: DS:[SI], ES:[DI]
    135				     ;================================================
    136	0150			     strcpy  proc
    137	0150			     @@Copy:
    138	0150  38 24			 cmp byte ptr ds:[si], ah
    139	0152  A4			 movsb
    140	0153  75 FB			 jne @@Copy
    141	0155  C3			 ret
    142	0156			     strcpy  endp
    143
    144				     ;================================================
    145				     ; Function	that compares two strings
    146				     ; ENTER: DS:[SI] -	First string
    147				     ;	      ES:[DI] -	Second string
    148				     ;	      AH - String terminator
    149				     ; EXIT:  AL - String differense
    150				     ; DESTR: DS:[SI], ES:[DI]
    151				     ;================================================
    152	0156			     strcmp  proc
    153	0156			     @@Compare:
    154	0156  38 24			 cmp byte ptr ds:[si], ah
    155	0158  74 0A			 je @@End
    156	015A  26: 38 25			 cmp byte ptr es:[di], ah
    157	015D  74 05			 je @@End
    158	015F  A6			 cmpsb
    159	0160  75 02			 jne @@End
    160	0162  EB F2			 jmp @@Compare
    161	0164			     @@End:
    162	0164  8A 44 FF			 mov al, byte ptr ds:[si-1]
    163	0167  26: 2A 45	FF		 sub al, byte ptr es:[di-1]
    164	016B  C3			 ret
    165	016C			     strcmp  endp
    166
    167				     end Start
Turbo Assembler	 Version 4.1	    02/25/20 01:38:22	    Page 4
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/25/20"
??FILENAME			  Text	 "memfunc "
??TIME				  Text	 "01:38:22"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@COMPARE			  Near	 DGROUP:0156
@@COPY				  Near	 DGROUP:0150
@@END				  Near	 DGROUP:0143
@@END				  Near	 DGROUP:014F
@@END				  Near	 DGROUP:0164
@@SEARCH			  Near	 DGROUP:013D
@@SEARCH			  Near	 DGROUP:0144
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 MEMFUNC
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
MEMCHR				  Near	 DGROUP:0128
MEMCMP				  Near	 DGROUP:012B
MEMCPY				  Near	 DGROUP:0138
MEMSET				  Near	 DGROUP:0135
START				  Near	 DGROUP:0100
STR1				  Byte	 DGROUP:0000
STR2				  Byte	 DGROUP:0006
STRCHR				  Near	 DGROUP:0144
STRCMP				  Near	 DGROUP:0156
STRCPY				  Near	 DGROUP:0150
STRLEN				  Near	 DGROUP:013B

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  000C Word	  Public  DATA
  _TEXT				  16  016C Word	  Public  CODE
